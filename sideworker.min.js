var SideWorker=function(){"use strict";const n=(n=!1)=>`\n${n&&"console.debug('SideWorker initialised.')"}\n[DUPA]\nvar ERROR_NOT_DEFINED = 'ERROR! FUNCTION NOT DEFINED!'\n\nfunction SideWorker() {\n  this.func = null\n  this.method = function (name, strfunc) {\n    eval('var func = ' + strfunc)\n\n    this[name] = function () {\n      var response = func.apply(this, arguments)\n      self.postMessage(name)\n      self.postMessage(response)\n      this.func = null\n    }\n  }\n}\n\nSideWorker.prototype.loadLibrary = function () {\n  importScripts().call(arguments)\n}\n\nworker = new SideWorker()\n\nself.addEventListener('message', function (e) {\n  if (!worker.func) {\n    worker.func = e.data\n    if (!worker[worker.func])\n      console.error(ERROR_NOT_DEFINED, worker.func)\n  } else {\n    var func = worker.func\n    worker.func = null\n\n    ${n&&"\n    if(func === 'method')\n      console.debug('Defining \"' + e.data[0] + '\".')\n    else\n      console.debug('Calling \"' + func + '\".')\n    "}\n\n    if (worker[func])\n      worker[func].apply(worker, e.data)\n    else\n      console.error(ERROR_NOT_DEFINED, worker[func])\n  }\n})\n`;return function({debug:e,init:t}={},...i){const r=new Blob([n(e)],{type:"text/javascript"}),s=window.URL.createObjectURL(r);this.worker=new Worker(s),window.URL.revokeObjectURL(s),this.func=null,this._cb={},this.callFunction=function(n,...e){this.worker.postMessage(n),this.worker.postMessage(e)},this.define=function(n,e,t){this.callFunction("method",n,e.toString()),this[n]=function(){this.callFunction(n,...arguments)}.bind(this),this._cb[n]=t||null}.bind(this),this.worker.addEventListener("message",function(n){this.func?(this._cb[this.func]&&this._cb[this.func](n.data),this.func=null):this.func=n.data}.bind(this)),t&&(this.define("init",t),this.init.apply(this,i))}}();
